<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.jeecg.modules.app.mapper.CoursesCouponMapper">

    <!--查询用户所有优惠卷-->
    <select id="queryCoursesCouponByUserId" resultType="org.jeecg.modules.app.vo.CoursesCouponVo">
        select cc.id,type,name,count,amount,start_time,end_time,min_point,use_type,course_id,category_id from courses_coupon as cc
        left join courses_coupon_relation as ccr on cc.id=ccr.coupon_id
        left join courses_coupon_category as ccc on cc.id=ccc.coupon_id
        where cc.id in (select coupon_id from courses_coupon_history where user_id=#{userId} and use_status=0)
        order by amount
    </select>

</mapper>